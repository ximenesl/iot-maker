<!DOCTYPE html>
<head>

 
CÓDIGO DO PROJETO CAIXA DE LEITE 

C++ (Arduino IDE) 

// Código em C++ para Arduino - leitura de botões e envio pela porta serial

// Mapeia os botões físicos para GPIOs do Arduino
const int botaoW = 4;
const int botaoA = 5;
const int botaoS = 6;
const int botaoD = 7;
const int botaoSpace = 8;

void setup() {
  // Define os botões como entrada com pull-up interno (ativa lógica invertida)
  pinMode(botaoW, INPUT_PULLUP);
  pinMode(botaoA, INPUT_PULLUP);
  pinMode(botaoS, INPUT_PULLUP);
  pinMode(botaoD, INPUT_PULLUP);
  pinMode(botaoSpace, INPUT_PULLUP);

  // Inicia comunicação serial com velocidade 115200
  Serial.begin(115200);
  delay(1000); // Aguarda estabilização
}

void loop() {
  // Verifica se botão W está pressionado
  if (digitalRead(botaoW) == LOW) {
    Serial.println("W");          // Envia "W" pela serial
    delay(200);                   // Espera para evitar múltiplos envios
    while (digitalRead(botaoW) == LOW) delay(10); // Espera soltar
  }

  // Botão A
  if (digitalRead(botaoA) == LOW) {
    Serial.println("A");
    delay(200);
    while (digitalRead(botaoA) == LOW) delay(10);
  }

  // Botão S
  if (digitalRead(botaoS) == LOW) {
    Serial.println("S");
    delay(200);
    while (digitalRead(botaoS) == LOW) delay(10);
  }

  // Botão D
  if (digitalRead(botaoD) == LOW) {
    Serial.println("D");
    delay(200);
    while (digitalRead(botaoD) == LOW) delay(10);
  }

  // Botão Espaço
  if (digitalRead(botaoSpace) == LOW) {
    Serial.println(" ");  // Espaço em branco representa pulo
    delay(200);
    while (digitalRead(botaoSpace) == LOW) delay(10);
  }

  delay(20); // Pequeno atraso para estabilidade
}


Python (Terminal/CMD)

# Código em Python que lê da porta serial e envia via UDP

import serial
import socket

# Define as configurações da serial e do destino UDP
SERIAL_PORT = "COM9"        # Porta COM usada pelo Arduino
BAUD_RATE = 115200
UDP_IP = "127.0.0.1"        # IP local (localhost)
UDP_PORT = 8888             # Porta que será usada no destino

# Inicializa comunicação serial e socket UDP
ser = serial.Serial(SERIAL_PORT, BAUD_RATE)
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

print(f"Enviando dados de {SERIAL_PORT} para {UDP_IP}:{UDP_PORT}")

# Loop infinito lendo a serial e enviando UDP
while True:
    try:
        line = ser.readline().decode().strip()       # Lê e remove espaços
        print("Serial ->", line)                     # Mostra no terminal
        sock.sendto(line.encode(), (UDP_IP, UDP_PORT))  # Envia via UDP
    except Exception as e:
        print("Erro:", e)  # Exibe erro, se ocorrer


C# (Unity)

// Código C# para receber comandos via UDP e controlar movimento na Unity

using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;
using UnityEngine;

public class UdpReceiver2D : MonoBehaviour
{
    UdpClient client;           // Cliente UDP para receber dados
    Thread receiveThread;       // Thread separada para escutar UDP
    public int port = 8888;     // Porta de escuta
    private string lastMessage = "";  // Última mensagem recebida

    private Rigidbody2D rb;     // Corpo do objeto
    public float force = 5f;    // Força de movimentação
    public float jumpForce = 8f; // Força do pulo

    void Start()
    {
        rb = GetComponent Rigidbody2D() ;  // Pega o Rigidbody2D do objeto

        // Inicia o cliente UDP e a thread de recepção
        client = new UdpClient(port);
        receiveThread = new Thread(ReceiveData);
        receiveThread.IsBackground = true;
        receiveThread.Start();
    }

    void ReceiveData()
    {
        IPEndPoint remoteEP = new IPEndPoint(IPAddress.Any, port);

        while (true)
        {
            try
            {
                // Recebe dados e converte para texto
                byte[] data = client.Receive(ref remoteEP);
                string text = Encoding.UTF8.GetString(data);
                Debug.Log("Recebido: " + text);
                lastMessage = text.Trim(); // Remove quebras de linha e espaços
            }
            catch (System.Exception e)
            {
                Debug.Log("Erro UDP: " + e.Message);
            }
        }
    }

    void FixedUpdate()
    {
        // Pega a velocidade atual
        Vector2 velocity = rb.velocity;

        // Verifica qual tecla foi enviada via UDP e move
        switch (lastMessage)
        {
            case "W":
                velocity.y = force; // Move para cima
                break;
            case "S":
                velocity.y = -force; // Move para baixo
                break;
            case "A":
                velocity.x = -force; // Esquerda
                break;
            case "D":
                velocity.x = force;  // Direita
                break;
            case "":
                // Nenhuma tecla pressionada
                break;
            case " ":
                velocity.y = jumpForce; // Pulo com espaço
                break;
        }

        rb.velocity = velocity;
        lastMessage = ""; // Limpa mensagem para não repetir ação
    }

    void OnApplicationQuit()
    {
        // Encerra a thread e o cliente ao sair do app
        receiveThread?.Abort();
        client?.Close();
    }
}

</head>
</html>
